<!DOCTYPE html>
<html>
<head>
    <title>Vizabi Testpages 019: Split Bubbles first Draft</title>

    <base href="/">

    <link rel="stylesheet" href="tools/bubble-chart/styles/bubble-chart.css">
    <link rel="stylesheet" href="bower_components/jquery-ui/themes/base/jquery-ui.css">

    <script src="bower_components/jquery/jquery.js" charset="utf-8"></script>
    <script src="bower_components/jquery-ui/ui/jquery-ui.js" charset="utf-8"></script>
    <script src="bower_components/d3/d3.js" charset="utf-8"></script>
    <script src="bower_components/queue-async/queue.js" charset="utf-8"></script>

    <script type="text/javascript" src="tools/bubble-chart/scripts/start.js" charset="utf-8"></script>
    <script type="text/javascript" src="common/scripts/helpers/util.js" charset="utf-8"></script>
    <script type="text/javascript" src="tools/bubble-chart/scripts/bubble-chart-model.js" charset="utf-8"></script>
    <script type="text/javascript" src="tools/bubble-chart/scripts/bubble-chart.js" charset="utf-8"></script>
    <script type="text/javascript" src="tools/bubble-chart/scripts/bubble-chart-datahelper.js" charset="utf-8"></script>
    <script type="text/javascript" src="tools/bubble-chart/scripts/viz/viz-bubble.js" chartset="utf-8"></script>
    <script type="text/javascript" src="tools/bubble-chart/scripts/viz/viz-bubble-print.js" chartset="utf-8"></script>

    <script type="text/javascript" src="vizabi-components/data-cube/data-cube.js" charset="utf-8"></script>
    <script type="text/javascript" src="vizabi-components/data-cube/loader/reader-multiple-json.js" charset="utf-8"></script>
    <script type="text/javascript" src="vizabi-components/data-cube/loader/reader-single-csv.js" charset="utf-8"></script>
    <script type="text/javascript" src="vizabi-components/data-cube/loader/reader-multiple-csv.js" charset="utf-8"></script>
    <script type="text/javascript" src="vizabi-components/data-cube/loader/reader-multi-csv.js" charset="utf-8"></script>
    <script type="text/javascript" src="vizabi-components/data-cube/loader-factory.js" charset="utf-8"></script>
    <script type="text/javascript" src="vizabi-components/data-cube/data-cube-i18n-layer.js" charset="utf-8"></script>

    <script type="text/javascript" src="widgets/settings-button/settings-button.js" charset="utf-8"></script>
    <script type="text/javascript" src="widgets/time-slider-jQueryUI/time-slider-jQueryUI.js" charset="utf-8"></script>
    <script type="text/javascript" src="widgets/chart-grid/chart-grid.js" chartset="utf-8"></script>
    <meta charset="UTF-8">
</head>
<body>
<div style="font-family: 'Calisto MT', 'Bookman Old Style', Bookman, 'Goudy Old Style', Garamond, 'Hoefler Text', 'Bitstream Charter', Georgia, serif;" align="center"> Vizabi Testpages description: Vizabi can show sub-national bubbles of indian and brazilian state and change the Y Indicator for them</div><br>
<div id="chartInfo"></div><div id="chartFooter"></div>
<br>
<div><button type="button" onclick="loadSubnational()">Show Indian & Brazilian Sub-national</button>
    <button type="button" onclick="unloadSubnational()">Hide Indian & Brazilian Sub-national</button>
    <button type="button" onclick="reloadIMR()">Change y indicator to IMR</button>
</div>
</div>
<script>
    var renderDiv = "chart-1";
    var chartState;
    var app;

    if (window.history.state === null) {
        var URL = window.location.href.toString();
        // When a new tab is opened
        if (URL.indexOf("#?") !== -1) {
            console.log("URL contains the character");
            var model = JSON.parse(URL.substr(URL.indexOf("#?") + 2, URL.length));
            history.pushState(model, "", "#?" + JSON.stringify(model));
            chartState = model;
        }
        else {
            chartState = {
                isInteractive: true,
                dataPath: "019/data/",
                year: 2003,
                fileFormat: "multiCSV",
                category: ["country"],
                xAxisScale: "log",
                //xAxisTickValues: [500, 1000, 1500, 2000, 3000, 5000, 7000, 10000, 15000, 30000, 40000, 60000, 80000 ],
                xAxisTickValues : [500, 5000, 50000],
                language : "en",
                speed: 0.1
            };
        }
    }
    else {
        chartState = window.history.state;
    }

    app = new gapminder.bubbleChart(renderDiv, chartState);

    app.registerStateBindCallback(function(model) {
        var currentState = window.history.state;

        if (!currentState) {
            history.pushState(model, "", "#?" + JSON.stringify(model));
        }
        else {
            history.replaceState(model, "", "#?" + JSON.stringify(model));
        }
    });

    var loadSubnational = function () {
        app.setState({category: ["country","adm1"], isSplitMode: true});
    };

    var unloadSubnational = function() {
        app.setState({category: ["country"]});
    };

    var reloadIMR = function () {
        app.setState({yIndicator: "imr"});
    };


</script>
</body>
</html>