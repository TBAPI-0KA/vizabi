<!DOCTYPE html>
<html>
<head>
    <title>Indian Sub-national Data</title>

    <link rel="stylesheet" href="../../../../../app/tools/bubble-chart/styles/bubbleChartStyles.css">
    <link rel="stylesheet" href="../../../../../app/bower_components/jquery-ui/themes/base/jquery-ui.css">

    <script src="../../../../../app/bower_components/jquery/jquery.js" charset="utf-8"></script>
    <script src="../../../../../app/bower_components/jquery-ui/ui/jquery-ui.js" charset="utf-8"></script>
    <script src="../../../../../app/bower_components/d3/d3.js" charset="utf-8"></script>
    <script src="../../../../../app/bower_components/queue-async/queue.js" charset="utf-8"></script>

    <script type="text/javascript" src="../../../../../app/tools/bubble-chart/scripts/start.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/common/scripts/helpers/util.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/tools/bubble-chart/scripts/bubbleChartModel.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/tools/bubble-chart/scripts/bubbleChart.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/tools/bubble-chart/scripts/bubbleChartDataHelper.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/tools/bubble-chart/scripts/viz/vizBubble.js" chartset="utf-8"></script>

    <script type="text/javascript" src="../../../../../app/vizabi-components/dataCube/dataCube.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/vizabi-components/dataCube/loader/readerMultipleJSON.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/vizabi-components/dataCube/loader/readerSingleCSV.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/vizabi-components/dataCube/loader/readerMultipleCSV.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/vizabi-components/dataCube/loader/readerMultiCSV.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/vizabi-components/dataCube/loaderFactory.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/vizabi-components/dataCube/dataCubei18nLayer.js" charset="utf-8"></script>

    <script type="text/javascript" src="../../../../../app/widgets/settings-button/settings-button.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/widgets/time-slider-jQueryUI/time-slider-jQueryUI.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../../../app/widgets/chart-grid/chart-grid.js" chartset="utf-8"></script>
    <meta charset="UTF-8">
</head>
<body>
<div id="chartInfo"></div><div id="chartFooter"></div>
</div>
<script>
    var renderDiv = "chart-1";
    var chartState;
    var app;

    if (window.history.state === null) {
        var URL = window.location.href.toString();
        // When a new tab is opened
        if (URL.indexOf("#?") !== -1) {
            console.log("URL contains the character");
            var model = JSON.parse(URL.substr(URL.indexOf("#?") + 2, URL.length));
            history.pushState(model, "", "#?" + JSON.stringify(model));
            chartState = model;
        }
        else {
            chartState = {
                isInteractive: true,
                dataPath: "data/",
                year: 2001,
                fileFormat: "multiCSV",
                category: ["ind1"],
                //xAxisTickValues: [0, 0.5, 1],
                //minXValue: 0,
                //maxXValue: 3,
                language : "en",
                xIndicator: "gdp_per_cap",
                yIndicator: "imr",
                sizeIndicator: "pop",
                speed: 0.02
                //minYValue: 0,
                //maxYValue: 100
            };
        }
    }
    else {
        chartState = window.history.state;
    }

    app = new gapminder.bubbleChart(renderDiv, chartState);
    app.registerStateBindCallback(function(model) {
        var currentState = window.history.state;

        if (!currentState) {
            history.pushState(model, "", "#?" + JSON.stringify(model));
        }
        else {
            history.replaceState(model, "", "#?" + JSON.stringify(model));
        }
    });

    $("#languageSelect").val(chartState.language);
    $("#languageSelect").change(function() {
        $( "#languageSelect option:selected" ).each(function() {
            app.setState({language: this.value.toString()});
        });
    });

    $("#indicatorChange").val(chartState.xIndicator);
</script>
</body>
</html>